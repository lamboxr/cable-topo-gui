# 线缆拓扑图生成器 - 打包说明

## 快速开始

### 方法一：使用批处理文件（推荐）
双击运行 `install_and_build.bat` 文件，它会自动：
1. 安装所有依赖
2. 安装 topo_creator 模块
3. 安装 PyInstaller
4. 打包生成 exe 文件

### 方法二：使用 Python 脚本
```bash
python build_complete.py
```

### 方法三：手动执行
```bash
# 1. 安装依赖
pip install -r requiements.txt
pip install topo_creator-0.0.1-py3-none-any.whl --force-reinstall
pip install pyinstaller

# 2. 打包
pyinstaller cable_topo.spec
```

## 文件说明

- `cable_topo.py` - 主程序入口文件
- `cable_topo.spec` - PyInstaller 配置文件
- `img/icon.ico` - 程序图标
- `topo_creator-0.0.1-py3-none-any.whl` - 核心功能模块
- `requiements.txt` - Python 依赖列表

## 生成的文件

打包成功后，会在 `dist` 目录下生成：
- `线缆拓扑图生成器.exe` - 单文件可执行程序

## 注意事项

1. 确保 Python 已安装并添加到 PATH
2. 确保网络连接正常（需要下载依赖包）
3. 打包过程可能需要几分钟时间
4. 生成的 exe 文件大小约为 100-200MB（包含所有依赖）

## 故障排除

### 如果遇到编码问题
在命令行中执行：
```bash
chcp 65001
```

### 如果 PyInstaller 打包失败
1. 检查是否有杀毒软件干扰
2. 尝试以管理员权限运行
3. 检查磁盘空间是否充足

### 如果运行时缺少模块
确保 `topo_creator-0.0.1-py3-none-any.whl` 文件存在并正确安装。

## 测试打包结果

打包完成后，可以：
1. 双击运行 `dist/线缆拓扑图生成器.exe`
2. 测试程序的各项功能
3. 确认图标显示正确